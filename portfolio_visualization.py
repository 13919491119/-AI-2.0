import matplotlib.pyplot as plt # pyright: ignore[reportMissingModuleSource]
import pandas as pd # pyright: ignore[reportMissingModuleSource]
import seaborn as sns # pyright: ignore[reportMissingModuleSource]

# 投资组合数据（与《投资组合配置表.md》一致）
portfolio_data = [
    # 重点投资组合
    {"组合": "重点投资", "组号": 7, "红球": "3,9,15,21,27,33", "蓝球": 3, "评分": 0.812, "评级": 5},
    {"组合": "重点投资", "组号": 23, "红球": "3,9,15,21,27,33", "蓝球": 3, "评分": 0.798, "评级": 4},
    {"组合": "重点投资", "组号": 9, "红球": "8,13,18,23,28,33", "蓝球": 13, "评分": 0.785, "评级": 4},
    {"组合": "重点投资", "组号": 17, "红球": "2,9,15,23,28,33", "蓝球": 7, "评分": 0.772, "评级": 4},
    {"组合": "重点投资", "组号": 4, "红球": "4,9,14,19,24,29", "蓝球": 9, "评分": 0.758, "评级": 3},
    # 适度配置组合
    {"组合": "适度配置", "组号": 3, "红球": "2,7,12,17,22,27", "蓝球": 12, "评分": 0.745, "评级": 3},
    {"组合": "适度配置", "组号": 27, "红球": "7,13,19,20,26,32", "蓝球": 7, "评分": 0.732, "评级": 3},
    {"组合": "适度配置", "组号": 1, "红球": "3,8,13,18,23,28", "蓝球": 8, "评分": 0.718, "评级": 3},
    {"组合": "适度配置", "组号": 8, "红球": "6,11,16,21,26,31", "蓝球": 11, "评分": 0.705, "评级": 3},
    {"组合": "适度配置", "组号": 12, "红球": "4,9,14,19,24,29", "蓝球": 5, "评分": 0.692, "评级": 3},
    # 其他配置组合（只展示部分，完整可扩展）
    {"组合": "其他配置", "组号": 2, "红球": "5,10,15,20,25,30", "蓝球": 10, "评分": 0.635, "评级": 3},
    {"组合": "其他配置", "组号": 5, "红球": "1,6,11,16,21,26", "蓝球": 16, "评分": 0.625, "评级": 2},
    {"组合": "其他配置", "组号": 6, "红球": "7,12,17,22,27,32", "蓝球": 7, "评分": 0.642, "评级": 3},
    {"组合": "其他配置", "组号": 10, "红球": "4,10,16,22,28,31", "蓝球": 4, "评分": 0.658, "评级": 3},
    {"组合": "其他配置", "组号": 11, "红球": "5,10,15,20,25,30", "蓝球": 10, "评分": 0.635, "评级": 3},
    {"组合": "其他配置", "组号": 13, "红球": "6,11,16,21,26,31", "蓝球": 15, "评分": 0.628, "评级": 2},
    {"组合": "其他配置", "组号": 14, "红球": "3,8,13,18,23,28", "蓝球": 8, "评分": 0.718, "评级": 3},
    {"组合": "其他配置", "组号": 15, "红球": "7,12,17,22,27,32", "蓝球": 12, "评分": 0.642, "评级": 3},
    {"组合": "其他配置", "组号": 16, "红球": "1,8,14,20,26,32", "蓝球": 9, "评分": 0.615, "评级": 2},
    {"组合": "其他配置", "组号": 18, "红球": "5,11,18,24,29,33", "蓝球": 11, "评分": 0.598, "评级": 2},
    {"组合": "其他配置", "组号": 19, "红球": "4,10,16,22,28,31", "蓝球": 6, "评分": 0.658, "评级": 3},
    {"组合": "其他配置", "组号": 20, "红球": "3,11,17,25,29,31", "蓝球": 14, "评分": 0.585, "评级": 2},
    {"组合": "其他配置", "组号": 21, "红球": "1,7,13,19,25,31", "蓝球": 1, "评分": 0.542, "评级": 2},
    {"组合": "其他配置", "组号": 22, "红球": "2,8,14,20,26,32", "蓝球": 2, "评分": 0.555, "评级": 2},
    {"组合": "其他配置", "组号": 24, "红球": "4,10,16,22,28,29", "蓝球": 4, "评分": 0.658, "评级": 3},
    {"组合": "其他配置", "组号": 25, "红球": "5,11,17,23,24,30", "蓝球": 5, "评分": 0.568, "评级": 2},
    {"组合": "其他配置", "组号": 26, "红球": "6,12,18,19,25,31", "蓝球": 6, "评分": 0.578, "评级": 2},
    {"组合": "其他配置", "组号": 28, "红球": "8,14,20,21,27,33", "蓝球": 8, "评分": 0.645, "评级": 3},
    {"组合": "其他配置", "组号": 29, "红球": "9,15,21,22,28,29", "蓝球": 9, "评分": 0.635, "评级": 3},
    {"组合": "其他配置", "组号": 30, "红球": "10,16,22,23,24,30", "蓝球": 10, "评分": 0.548, "评级": 2},
    {"组合": "其他配置", "组号": 31, "红球": "11,17,23,25,26,31", "蓝球": 11, "评分": 0.523, "评级": 1},
]

df = pd.DataFrame(portfolio_data)

# 1. 各组合评分分布可视化
plt.figure(figsize=(10, 6))
sns.boxplot(x="组合", y="评分", data=df, palette="Set2")
plt.title("各投资组合评分分布")
plt.ylabel("综合评分")
plt.xlabel("")
plt.grid(axis="y", linestyle=":", alpha=0.5)
plt.tight_layout()
plt.savefig("portfolio_score_boxplot.png")
plt.show()

# 2. 各组合组数与平均评分
group_stats = df.groupby("组合").agg({"组号": "count", "评分": "mean"}).reset_index()
plt.figure(figsize=(8, 5))
ax = group_stats.plot.bar(x="组合", y=["组号", "评分"], secondary_y="评分", rot=0, legend=True)
plt.title("各投资组合组数与平均评分")
plt.ylabel("组数")
ax.right_ax.set_ylabel("平均评分")
plt.tight_layout()
plt.savefig("portfolio_group_stats.png")
plt.show()

# 3. 评分分布直方图
plt.figure(figsize=(8, 5))
sns.histplot(df["评分"], bins=10, kde=True, color="#4C72B0")
plt.title("所有组合评分分布直方图")
plt.xlabel("综合评分")
plt.ylabel("组数")
plt.tight_layout()
plt.savefig("portfolio_score_hist.png")
plt.show()

print("可视化图片已保存：portfolio_score_boxplot.png, portfolio_group_stats.png, portfolio_score_hist.png")
